<script>

window.addEventListener('load', function() {
  console.log('Page is loaded')
  runGetData()  
})

function runGetData(){

  showLoading(true) // show loading view
  
  // Get data from spreadsheet 
  google.script.run
  
  // if successful, display the data 
  .withSuccessHandler(function(res){
    showData(res) // show the data
    showLoading(false) // hide loading view
  })
  
  // if error
  .withFailureHandler(function(err){
    console.error("error occured", err);
  })
  
  .getData() // run function in gs file to pull data
  
}

function showData(data){
  // display buyer names
  var buyerNamesHTML = ''
  for (var i = 0; i < data.buyerNames.length; i++){
    buyerNamesHTML += '<div class="row"><span>' + data.buyerNames[i] + '</span></div>'
  }
  
  // display buyer agent names
  var buyerAgentsHTML = ''
  for (var i = 0; i < data.buyerAgents.length; i++){
    buyerAgentsHTML += '<div class="row"><span>' + data.buyerAgents[i] + '</span></div>'
  }
  
  // display stages
  var stagesHTML = ''
  for (var i = 0; i < data.stages.length; i++){
    stagesHTML += '<div class="row"><span>' + data.stages[i] + '</span></div>'
  }
  
  // display listing agents
  var listingAgentsHTML = ''
  for (var i = 0; i < data.listingAgents.length; i++){
    listingAgentsHTML += '<div class="row"><span>' + data.listingAgents[i] + '</span></div>'
  }
  
  document.getElementById('showBuyers').innerHTML = buyerNamesHTML
  document.getElementById('showBuyerAgents').innerHTML = buyerAgentsHTML
  document.getElementById('showStages').innerHTML = stagesHTML
  document.getElementById('showListingAgents').innerHTML = listingAgentsHTML
}

function showLoading(bool){
  var displayBack = ''
  var displayLoading = ''
  if (bool){
    displayBack = 'block'
    displayLoading = 'in-line'
  }
  else {
    displayBack = 'none'
    displayLoading = 'none'
  }
  document.getElementById('darkBack').style.display = displayBack
  document.getElementById('loading').style.display = displayBack
}

</script>